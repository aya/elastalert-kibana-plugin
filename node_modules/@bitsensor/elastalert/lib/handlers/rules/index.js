'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = rulesHandler;

var _route_logger = require('src/routes/route_logger');

var _route_logger2 = _interopRequireDefault(_route_logger);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var logger = new _route_logger2.default('/rules');

function rulesHandler(request, result) {
  /**
   * @type {ElastalertServer}
   */
  var server = request.app.get('server');

  var path = request.query.path || '';

  server.rulesController.getRules(path).then(function (rules) {
    result.send(rules);
    logger.sendSuccessful();
  }).catch(function (error) {
    if (error.code) {
      result.status(error.code).send(error);
    } else {
      result.status(500).send(error);
    }
    logger.sendFailed(error);
  });
}